Description: Exit if the number of glyphs is zero to avoid a heap overflow.
 Fixes CVE-2022-31782.
Author: Alexei Podtelezhnikov <apodtele@gmail.com>
Origin: https://gitlab.freedesktop.org/freetype/freetype-demos/-/commit/3541af5e7805a4d897b8a1b199eb5037b9f1a477
Bug: https://gitlab.freedesktop.org/freetype/freetype-demos/-/issues/8
Last-Update: 2022-05-24

---
 ft2demos/src/ftbench.c | 3 +++
 1 file changed, 3 insertions(+)

--- a/ft2demos/src/ftbench.c
+++ b/ft2demos/src/ftbench.c
@@ -1242,6 +1242,9 @@
     if ( get_face( &face ) )
       goto Exit;
 
+    if ( !face->num_glyphs )
+      goto Exit;
+
     if ( first_index >= face->num_glyphs )
       first_index = face->num_glyphs - 1;
     if ( last_index >= face->num_glyphs )
